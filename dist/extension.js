(()=>{"use strict";var e={137(e,t,n){var i,o=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||(i=function(e){return i=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},i(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=i(e),s=0;s<n.length;s++)"default"!==n[s]&&o(t,e,n[s]);return r(t,e),t}),a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(o,r){function s(e){try{d(i.next(e))}catch(e){r(e)}}function a(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}d((i=i.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.XMindDocument=void 0;const d=s(n(398)),c=n(697);class u extends c.Disposable{static create(e,t,n){return a(this,void 0,void 0,function*(){const i="string"==typeof t?d.Uri.parse(t):e,o=yield u.readFile(i);return new u(e,o,n)})}static readFile(e){return a(this,void 0,void 0,function*(){return"untitled"===e.scheme?new Uint8Array:new Uint8Array(yield d.workspace.fs.readFile(e))})}constructor(e,t,n){super(),this._onDidDispose=this._register(new d.EventEmitter),this.onDidDispose=this._onDidDispose.event,this._onDidChangeDocument=this._register(new d.EventEmitter),this.onDidChangeContent=this._onDidChangeDocument.event,this._onDidChange=this._register(new d.EventEmitter),this.onDidChange=this._onDidChange.event,this._uri=e,this._documentData=t,this._delegate=n}get uri(){return this._uri}get documentData(){return this._documentData}dispose(){this._onDidDispose.fire(),super.dispose()}makeEdit(){this._onDidChange.fire({label:"Edit",undo:()=>a(this,void 0,void 0,function*(){}),redo:()=>a(this,void 0,void 0,function*(){})})}save(e){return a(this,void 0,void 0,function*(){yield this.saveAs(this.uri,e)})}saveAs(e,t){return a(this,void 0,void 0,function*(){const n=yield this._delegate.getFileData();t.isCancellationRequested||(yield d.workspace.fs.writeFile(e,n))})}revert(e){return a(this,void 0,void 0,function*(){const e=yield u.readFile(this.uri);this._documentData=e,this._onDidChangeDocument.fire({content:e})})}backup(e,t){return a(this,void 0,void 0,function*(){return yield this.saveAs(e,t),{id:e.toString(),delete:()=>a(this,void 0,void 0,function*(){try{yield d.workspace.fs.delete(e)}catch(e){}})}})}}t.XMindDocument=u},240(e,t,n){var i,o=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||(i=function(e){return i=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},i(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=i(e),s=0;s<n.length;s++)"default"!==n[s]&&o(t,e,n[s]);return r(t,e),t}),a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(o,r){function s(e){try{d(i.next(e))}catch(e){r(e)}}function a(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}d((i=i.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.XMindEditorProvider=void 0;const d=s(n(398)),c=n(137),u=n(697),l=n(746);class h{static register(e){const t=new h(e);return d.window.registerCustomEditorProvider(h.viewType,t,{webviewOptions:{retainContextWhenHidden:!0},supportsMultipleEditorsPerDocument:!1})}constructor(e){this.context=e,this.webviews=new v,this._onDidChangeCustomDocument=new d.EventEmitter,this.onDidChangeCustomDocument=this._onDidChangeCustomDocument.event,this._requestIdPool=0,this._callbacks=new Map}openCustomDocument(e,t,n){return a(this,void 0,void 0,function*(){const n=yield c.XMindDocument.create(e,t.backupId,{getFileData:()=>a(this,void 0,void 0,function*(){const e=Array.from(this.webviews.get(n.uri));if(!e.length)throw new Error("Could not find webview to save for");const t=e[0],i=yield this.postMessageWithResponse(t,"getFileData",{});return new Uint8Array(i)})}),i=[];return i.push(n.onDidChange(e=>{this._onDidChangeCustomDocument.fire(Object.assign({document:n},e))})),i.push(n.onDidChangeContent(e=>{var t;for(const i of this.webviews.get(n.uri))this.postMessage(i,"update",{data:Array.from(null!==(t=e.content)&&void 0!==t?t:new Uint8Array)})})),n.onDidDispose(()=>(0,u.disposeAll)(i)),n})}resolveCustomEditor(e,t,n){return a(this,void 0,void 0,function*(){this.webviews.add(e.uri,t),t.webview.options={enableScripts:!0},t.webview.onDidReceiveMessage(t=>this.onMessage(e,t)),t.webview.onDidReceiveMessage(n=>{if("ready"===n.type){const n=e.documentData;this.postMessage(t,"update",{data:Array.from(n)})}}),t.webview.html=this.getHtmlForWebview(t.webview)})}saveCustomDocument(e,t){return e.save(t)}saveCustomDocumentAs(e,t,n){return e.saveAs(t,n)}revertCustomDocument(e,t){return e.revert(t)}backupCustomDocument(e,t,n){return e.backup(t.destination,n)}postMessage(e,t,n){e.webview.postMessage({type:t,body:n})}postMessageWithResponse(e,t,n){const i=this._requestIdPool++,o=new Promise(e=>{this._callbacks.set(i,e)});return e.webview.postMessage({type:t,requestId:i,body:n}),o}onMessage(e,t){switch(t.type){case"edit":e.makeEdit();break;case"response":const n=this._callbacks.get(t.requestId);return void(null==n||n(t.body))}}getHtmlForWebview(e){const t=e.asWebviewUri(d.Uri.joinPath(this.context.extensionUri,"dist","webview.js"));return`\n\t\t\t<!DOCTYPE html>\n\t\t\t<html lang="en">\n\t\t\t<head>\n\t\t\t\t<meta charset="UTF-8">\n\t\t\t\t<meta name="viewport" content="width=device-width, initial-scale=1.0">\n\t\t\t\t<title>XMind Viewer</title>\n                <style>\n                    html, body { \n                        margin: 0; \n                        padding: 0; \n                        width: 100%; \n                        height: 100%; \n                        overflow: hidden; \n                        background-color: #fff; \n                        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;\n                        display: flex;\n                        flex-direction: column;\n                    }\n                    #mindmap { \n                        flex: 1;\n                        width: 100%; \n                        height: 0; /* Important for flex-grow to work correctly */\n                        position: relative;\n                        background: #fff;\n                    }\n                    #tab-container { \n                        flex-shrink: 0;\n                        height: 36px; \n                        background: #f0f0f0; \n                        border-top: 1px solid #ccc; \n                        display: flex; \n                        align-items: center; \n                        padding: 0 10px;\n                        overflow: hidden;\n                        z-index: 100;\n                    }\n                    .tab { \n                        padding: 4px 12px; \n                        margin-right: 2px; \n                        cursor: pointer; \n                        font-size: 12px; \n                        color: #555; \n                        background: #e1e1e1;\n                        border: 1px solid #ccc;\n                        border-bottom: none;\n                        border-radius: 4px 4px 0 0;\n                        white-space: nowrap;\n                        transition: background 0.2s;\n                        align-self: flex-end;\n                    }\n                    .add-tab {\n                        font-weight: bold;\n                        color: #333;\n                        background: #ddd;\n                        padding: 4px 10px;\n                    }\n                    #layout-select {\n                        background: #fff;\n                        border: 1px solid #ccc;\n                        border-radius: 3px;\n                        outline: none;\n                    }\n                    .tab.active { \n                        background: #fff; \n                        color: #000; \n                        font-weight: 600;\n                        position: relative;\n                        top: 1px; /* Overlap the border-top of container */\n                    }\n                    .tab:hover { background: #d0d0d0; }\n                    .tab.active:hover { background: #fff; }\n                </style>\n\t\t\t</head>\n\t\t\t<body>\n\t\t\t\t<div id="mindmap"></div>\n                <div id="tab-container"></div>\n\t\t\t\t<script nonce="${(0,l.getNonce)()}" src="${t}"><\/script>\n\t\t\t</body>\n\t\t\t</html>`}}t.XMindEditorProvider=h,h.viewType="vscode-xmind-viewer.xmindEditor";class v{constructor(){this._webviews=new Set}*get(e){const t=e.toString();for(const e of this._webviews)e.resource===t&&(yield e.webviewPanel)}add(e,t){const n={resource:e.toString(),webviewPanel:t};this._webviews.add(n),t.onDidDispose(()=>{this._webviews.delete(n)})}}},398(e){e.exports=require("vscode")},697(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Disposable=void 0,t.disposeAll=function(e){for(;e.length;){const t=e.pop();t&&t.dispose()}},t.Disposable=class{constructor(){this._disposables=[]}dispose(){for(;this._disposables.length;){const e=this._disposables.pop();e&&e.dispose()}}_register(e){return this._disposables.push(e),e}}},746(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getNonce=function(){let e="";for(let t=0;t<32;t++)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return e}}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var r=t[i]={exports:{}};return e[i].call(r.exports,r,r.exports,n),r.exports}var i={};(()=>{var e=i;Object.defineProperty(e,"__esModule",{value:!0}),e.activate=function(e){e.subscriptions.push(t.XMindEditorProvider.register(e))},e.deactivate=function(){};const t=n(240)})();var o=exports;for(var r in i)o[r]=i[r];i.__esModule&&Object.defineProperty(o,"__esModule",{value:!0})})();